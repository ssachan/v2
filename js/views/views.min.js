window.HeaderView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render");this.model.bind("change",this.render);this.render()},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.FooterView=Backbone.View.extend({initialize:function(){this.render()},render:function(){$(this.el).html(this.template());return this}});window.LandingView=Backbone.View.extend({className:"container landing",initialize:function(){this.render()},render:function(){$(this.el).html(this.template());return this}});window.LearnMoreView=Backbone.View.extend({className:"container learn",initialize:function(){this.active=this.options.menu},changeMenu:function(e){$("#"+this.active+"-div").hide();this.active=e;$("#"+this.active+"-div").show();$("#"+this.active+"-menu").addClass("active")},render:function(){$(this.el).html(this.template());return this},onRender:function(){$("#pq-div").hide();$("#tests-div").hide();$("#faculty-div").hide();$("#feedback-div").hide();$("#choice-div").hide();$("#started-div").hide();this.changeMenu(this.active)}});window.DashboardView=Backbone.View.extend({className:"container dashboard",initialize:function(){this.activeMenu=null;this.activeView=null},switchView:function(e){if(this.activeView!=null)this.activeView.close();$("#main-content",this.el).html(e.render().el);e.onRender();this.activeView=e;return e},switchMenu:function(e){if(this.activeMenu!=null){$("#"+this.activeMenu+"-nav").removeClass("active")}if(this.activeMenu!=e){this.activeMenu=e;$("#"+this.activeMenu+"-nav").addClass("active");$("#main-content").empty()}},render:function(){$(this.el).html(this.template());return this},onRender:function(){}});window.OverView=Backbone.View.extend({className:"overall",initialize:function(){_.bindAll(this,"render");this.model.bind("change",this.render);this.model.bind("change",this.onRender)},uploadImage:function(){var e=$("#upload");var t=$("#status");var n=this;new AjaxUpload(e,{action:Config.serverUrl+"uploadImage",name:"file",type:"POST",onSubmit:function(e,n){if(!(n&&/^(jpg|png|jpeg|gif)$/.test(n))){t.text("Only JPG, PNG or GIF files are allowed");return false}t.text("Uploading...")},onComplete:function(e,r){t.text("");n.model.set("dp",true);$("#dp img").attr("src",n.model.get("dpUrl")+"?timestamp="+(new Date).getTime())}})},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this},onRender:function(){$("#result-square").empty();var e=sectionL1.models;var t=e.length;for(var n=0;n<t;n++){var r=new PerformanceView({model:e[n]});$("#result-square").append(r.render().el);r.onRender()}}});window.PerformanceView=Backbone.View.extend({className:"subject",initialize:function(){this.activel2Id="0";this.activel3Id="0";this.stats=null},events:{"click .l1":"onL1Click","click .l2 li":"onL2Click","click .l3 li":"onL3Click"},onL1Click:function(e){$("#"+this.activel2Id+"-l2").removeClass("active");this.activel2Id="0";$(".l3",this.el).empty();$(".l3-stats",this.el).hide();this.activel3Id="0";this.renderL1Stats()},onL2Click:function(e){$(".l3",this.el).empty();$(".l3-stats",this.el).hide();this.activel3Id="0";$("#"+this.activel2Id+"-l2").removeClass("active");this.activel2Id=e.target.parentElement.getAttribute("lid");$("#"+this.activel2Id+"-l2").addClass("active");this.renderL3();this.renderL2Stats()},onL3Click:function(e){if(this.activel3Id!=e.target.parentElement.getAttribute("lid")){$("#"+this.activel3Id+"-l3").removeClass("active");this.activel3Id=e.target.parentElement.getAttribute("lid");$("#"+this.activel3Id+"-l3").addClass("active");this.renderL3Stats()}},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this},onRender:function(){var e=sectionL2.where({l1Id:this.model.get("id")});var t=e.length;for(var n=0;n<t;n++){$(".l2",this.el).append('<li id="'+e[n].get("id")+'-l2" lid="'+e[n].get("id")+'"><a>'+e[n].get("displayName")+"</a></li>");var r=scoreL2.get(e[n].get("id"));if(r!=null){var i=parseInt(r.get("score"));if(i>80){$("#"+e[n].get("id")+"-l2>a",this.el).addClass("bg-green")}else if(i>=30&&i<=80){$("#"+e[n].get("id")+"-l2>a",this.el).addClass("bg-yellow")}else if(i<30&&i>0){$("#"+e[n].get("id")+"-l2>a",this.el).addClass("bg-red")}else if(i==0){$("#"+e[n].get("id")+"-l2>a",this.el).addClass("bg-grey")}}else{$("#"+e[n].get("id")+"-l2>a",this.el).addClass("bg-grey")}}this.renderL1Stats()},renderStats:function(e){if(e!=null){$(".l3-stats #bar",this.el).html('<div class="bar bar-warning" style="width:'+parseInt(e.get("score"))+'%"></div>');$(".l3-stats #pts",this.el).html(parseInt(e.get("score")));$(".l3-stats #total",this.el).html(parseInt(e.get("numQuestions")));$(".l3-stats #correct",this.el).html(parseInt(e.get("numCorrect")));$(".l3-stats #incorrect",this.el).html(parseInt(e.get("numIncorrect")));$(".l3-stats #unattempted",this.el).html(parseInt(e.get("numUnattempted")));var t=parseInt(e.get("score"));if(t>80){$(".l3-stats #pts",this.el).html("Expert")}else if(t>=30&&t<=80){$(".l3-stats #pts",this.el).html("Getting There")}else if(t<30&&t>0){$(".l3-stats #pts",this.el).html("Struggling")}else if(t==0){$(".l3-stats #pts",this.el).html("Not Started")}}else{$(".l3-stats #bar",this.el).html('<div class="bar bar-warning" style="width:'+parseInt("0")+'%"></div>');$(".l3-stats #pts",this.el).html("Not Started");$(".l3-stats #total",this.el).html("0");$(".l3-stats #correct",this.el).html("0");$(".l3-stats #incorrect",this.el).html("0");$(".l3-stats #unattempted",this.el).html("0")}$(".l3-stats",this.el).show()},renderL1Stats:function(){var e=scoreL1.get(this.model.get("id"));var t=this.model.get("displayName");$(".l3-stats #topic",this.el).html(t);this.renderStats(e);$("#btns").show()},renderL2Stats:function(){var e=this;var t=scoreL2.get(e.activel2Id);var n=sectionL2.get(e.activel2Id).get("displayName");$(".l3-stats #topic",this.el).html(n);this.renderStats(t);$("#btns").show()},renderL3:function(){$(".l3",this.el).empty();var e=sectionL3.where({l2Id:this.activel2Id});var t=e.length;for(var n=0;n<t;n++){$(".l3",this.el).append('<li id="'+e[n].get("id")+'-l3" lid="'+e[n].get("id")+'"><a>'+e[n].get("displayName")+"</a></li>");var r=scoreL3.get(e[n].get("id"));if(r!=null){var i=parseInt(r.get("score"));if(i>80){$("#"+e[n].get("id")+"-l3>a",this.el).addClass("bg-green")}else if(i>=30&&i<=80){$("#"+e[n].get("id")+"-l3>a",this.el).addClass("bg-yellow")}else if(i<30&&i>0){$("#"+e[n].get("id")+"-l3>a",this.el).addClass("bg-red")}else if(i==0){$("#"+e[n].get("id")+"-l3>a",this.el).addClass("bg-grey")}}else{$("#"+e[n].get("id")+"-l3>a",this.el).addClass("bg-grey")}}},renderL3Stats:function(){var e=this;var t=scoreL3.get(e.activel3Id);var n=sectionL3.get(e.activel3Id).get("displayName");$(".l3-stats #topic",this.el).html(n);this.renderStats(t);$("#btns").hide()}});window.ActivityView=Backbone.View.extend({className:"overall",initialize:function(){},render:function(){$(this.el).html(this.template());return this},onRender:function(){if(account.get("quizzesAttemptedArray").length==0){$("#insight").html("Please take a test and come back to this section");return}var e=this.collection.models;var t=e.length;$("#rec-quizzes").html("");for(var n=0;n<t;n++){$(".thumbnails").append((new QuizItemView({model:e[n],className:"span12"})).render().el)}drawDonutChart("donut");$("tspan:contains('Highcharts.com')").hide()}});window.InstructionsView=Backbone.View.extend({className:"container instructions",initialize:function(){},events:{"click .start-quiz":"startQuiz"},startQuiz:function(e){var t=e.currentTarget.getAttribute("id");this.model.set("attemptedAs",t);this.model.updateAttemptedAs();logs.reset();logs.addEntry("TEST_START");helper.track("mode",{id:t,accountId:account.get("id"),email:account.get("email")})},render:function(){$(this.el).html(this.template({totalQuestions:this.model.get("questionIdsArray").length,totalTime:helper.formatTime(this.model.get("allotedTime")),descriptionShort:this.model.get("descriptionShort")}));return this}});window.ResumeView=Backbone.View.extend({initialize:function(){},events:{"click #resume-quiz":"resume"},resume:function(){if(this.model.get("attemptedAs")==1){Manager.loadQuiz(this.model)}else{Manager.loadPractice(this.model)}},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.QuizView=Backbone.View.extend({className:"container quizview",initialize:function(){var e=this;this.index=this.options.index;this.questionView=new QuizQuestionView;this.question=null;this.questionIds=this.model.get("questionIdsArray");this.totalQuestions=this.questionIds.length;timer.setUpdateFunction(e.updateQuizTimer,[e]);this.warning=true;window.onbeforeunload=function(){if(e.warning){return""}}},events:{"click #previous":"onPreviousClick","click #next":"onNextClick","click .qnolist":"onQNoClick","click #submit":"submitQuiz"},startQuiz:function(){this.renderQuestion();timer.reset();timer.start()},submitQuiz:function(){if(confirm("Are you sure you want to submit")){timer.stop();logs.addEntry("QUESTION_CLOSE",this.question.get("id"));logs.addEntry("TEST_SUBMIT");logs.sort();this.model.set("timeTaken",timer.count);this.model.set("state",this.totalQuestions);this.model.submitQuiz()}},updateQuizTimer:function(e){$("#time").html(helper.formatTime(parseInt(e.model.get("allotedTime"))-parseInt(timer.count*1e3)));var t=e.question.get("timeTaken");t++;e.question.set("timeTaken",t);if(timer.count==e.model.get("allotedTime")){alert("time up");this.submitQuiz()}},onPreviousClick:function(){logs.addEntry("QUESTION_CLOSE",this.question.get("id"));$("#"+this.index).removeClass("active");if(this.question.get("optionSelected")){$("#"+this.index).addClass("attempted")}else{$("#"+this.index).removeClass("attempted")}this.index--;if(this.index<0){return}this.renderQuestion()},onNextClick:function(){logs.addEntry("QUESTION_CLOSE",this.question.get("id"));$("#"+this.index).removeClass("active");if(this.question.get("optionSelected")){$("#"+this.index).addClass("attempted")}else{$("#"+this.index).removeClass("attempted")}this.index++;if(this.index>=this.totalQuestions){return}this.renderQuestion()},onQNoClick:function(e){logs.addEntry("QUESTION_CLOSE",this.question.get("id"));$("#"+this.index).removeClass("active");if(this.question.get("optionSelected")){$("#"+this.index).addClass("attempted")}else{$("#"+this.index).removeClass("attempted")}this.index=e.currentTarget.getAttribute("id");this.renderQuestion()},render:function(){$(this.el).html(this.template({totalQuestions:this.totalQuestions}));return this},onRender:function(){$("#topic-head").html(this.model.get("l1DisplayName")+" : "+this.model.get("descriptionShort"))},renderQuestion:function(){$("#"+this.index).addClass("active");this.question=quizQuestions.get(this.questionIds[this.index]);if(this.question.get("timeTaken")==null){this.question.set("timeTaken",0)}this.question.set("hasAttempted",false);this.questionView.model=this.question;$("#question").html(this.questionView.render().el);this.questionView.render();this.questionView.onRender();$("#qnum").html(parseInt(this.index)+1);$("#qtotal").html(this.totalQuestions);$("#previous").show();$("#next").show();if(this.index==0){$("#previous").hide()}else if(this.index==this.totalQuestions-1){$("#next").hide()}return null},close:function(){window.onbeforeunload=null;Backbone.View.prototype.close.call(this)}});window.PracticeView=Backbone.View.extend({className:"container quizview",initialize:function(){var e=this;this.index=this.options.index;this.questionView=new QuizQuestionView;this.question=null;this.questionIds=this.model.get("questionIdsArray");this.totalQuestions=this.questionIds.length;this.setUp();timer.setUpdateFunction(e.updateQuizTimer,[e]);this.warning=true;window.onbeforeunload=function(){if(e.warning){return""}}},setUp:function(){this.answersSelected=this.model.get("selectedAnswersArray");this.getTimeTakenPerQuestion=this.model.get("timePerQuestionArray");for(var e=0;e<=this.index;e++){var t=quizQuestions.get(this.questionIds[e]);if(this.getTimeTakenPerQuestion[e]!=null){t.set("timeTaken",this.getTimeTakenPerQuestion[e]);t.set("optionSelected",this.answersSelected[e]);t.setStatus();t.set("hasAttempted",true)}}},events:{"click #previous":"onPreviousClick","click #next":"onNextClick","click #submit":"submitQuestion","click #pause":"pauseQuiz"},startQuiz:function(){timer.reset();this.renderQuestion()},onQNoClick:function(e){this.index--;if(this.index<0){return}this.renderQuestion()},submitQuestion:function(){timer.stop();this.question.set("timeTaken",timer.count*1e3);timer.reset();this.question.set("hasAttempted",true);this.question.setStatus();switch(this.question.get("status")){case true:$("#"+this.index).addClass("right");break;case false:$("#"+this.index).addClass("wrong");break;default:$("#"+this.index).addClass("unattempted");break}logs.addEntry("QUESTION_CLOSE",this.question.get("id"));$("#previous").show();$("#next").show();if(this.index==0){$("#previous").hide()}this.model.set("state",this.index);this.model.submitPracticeQuestion();this.renderQuestion()},pauseQuiz:function(){window.location="#"},updateQuizTimer:function(e){$("#time").html(helper.formatTime(timer.count*1e3))},onPreviousClick:function(){this.index--;if(this.index<0){return}this.renderQuestion()},onNextClick:function(){this.index++;if(this.index==this.totalQuestions){logs.reset();this.model.set("state",this.index);this.model.set("status",this.model.STATUS_COMPLETED);this.model.submitPracticeResults();return}this.renderQuestion()},render:function(){$(this.el).html(this.template({totalQuestions:this.totalQuestions}));return this},onRender:function(){$("#side-nav").hide();$("#topic-head").html(this.model.get("l1DisplayName")+" : "+this.model.get("descriptionShort"))},renderQuestion:function(){this.questionView.close();this.question=quizQuestions.get(this.questionIds[this.index]);if(this.question.get("timeTaken")==null){this.question.set("timeTaken",0)}this.questionView.model=this.question;$("#question").html(this.questionView.render().el);this.questionView.onRender();if(this.question.get("hasAttempted")==false){logs.reset();logs.addEntry("QUESTION_OPEN",this.question.get("id"));timer.start();$("#previous").hide();$("#next").hide();$("#submit").show();$("#pause").hide()}else{$("#pause").show()}$("#qnum").html(parseInt(this.index)+1);$("#qtotal").html(this.totalQuestions);return null},close:function(){window.onbeforeunload=null;Backbone.View.prototype.close.call(this)}});window.QuizQuestionView=Backbone.View.extend({initialize:function(){},events:{"click #single-type button":"handleSingleType","click #multiple-type button":"handleMultipleType","keypress #integer-type":"checkIntegerType","change #integer-type":"handleIntegerType","click #matrix-type input":"handleMatrixType"},handleSingleType:function(e){var t=this.model.get("optionSelected");var n=e.target.value;if(n===t){logs.addEntry("OPTION_DESELECT",this.model.get("id"),t);this.model.set("optionSelected",null);$(e.target).removeClass("active");e.stopPropagation()}else{if(t!==null)logs.addEntry("OPTION_DESELECT",this.model.get("id"),t);logs.addEntry("OPTION_SELECT",this.model.get("id"),n);this.model.set("optionSelected",n)}},handleMultipleType:function(e){var t=[];var n=this.model.get("optionSelected");var r=this.model.get("options").split(SEPARATOR).length;if(n!=null){var i=n.split(SEPARATOR);for(var s=0;s<r;s++){t[s]=i.indexOf(""+s)!=-1?1:0}}else{for(var s=0;s<r;s++){t[s]=0}}var o=e.target.getAttribute("class");var u=parseInt(e.target.getAttribute("value"));if(o.indexOf("active")!=-1){logs.addEntry("OPTION_DESELECT",this.model.get("id"),u);t[u]=0}else{logs.addEntry("OPTION_SELECT",this.model.get("id"),u);t[u]=1}var i=[];for(var a=0;a<r;a++){if(t[a]){i.push(a)}}n=i.join(SEPARATOR);this.model.set("optionSelected",n)},checkIntegerType:function(e){},handleIntegerType:function(e){this.model.set("optionSelected",$("#integer-type").val());logs.addEntry("OPTION_SELECT",this.model.get("id"),this.model.get("optionSelected"))},handleMatrixType:function(e){var t=[];var n=this.model.get("optionSelected");if(n!=null){t=n.split(SEPARATOR+SEPARATOR)}else{var r=this.model.get("options").split(SEPARATOR+SEPARATOR)[0].split(SEPARATOR).length;for(var i=0;i<r;i++){t[i]=null}}var s=e.target.getAttribute("name");var o=parseInt(s.split("-")[1]);var u=$("."+s+":checked");var a=[];var r=u.length;for(var f=0;f<r;f++){a.push(u[f].value)}t[o]=a.join(SEPARATOR);this.model.set("optionSelected",t.join(SEPARATOR+SEPARATOR))},render:function(){$(this.el).html(this.template(this.model.toJSON()));this.delegateEvents();return this},onRender:function(){this.renderOptions();$("#qtype").html(this.model.get("typeString"));$("#status").hide();$("#solution").hide();$("#q-video").hide();if(this.model.get("hasAttempted")){this.renderInfo();$("#analytics").show();$("#hq").html("Solution")}else{logs.addEntry("QUESTION_OPEN",this.model.get("id"));$("#analytics").hide();$("#hq").html("Question")}$(".quizview").bind("contextmenu",function(e){e.preventDefault()});var e=document.getElementById("quiz-view");MathJax.Hub.Queue(["Typeset",MathJax.Hub,e])},renderOptions:function(){var e=[];var t=[];var n=this.model.get("options");var r=this.model.get("optionSelected");switch(this.model.get("typeId")){case"1":e.push('<div class="span10"><div class="option-box"><ol type="A">');t.push('<div class="span2 btn-group" data-toggle="buttons-radio" id="single-type">');var i=n.split(SEPARATOR);var s=i.length;for(var o=0;o<s;o++){e.push("<li>"+i[o]+"</li>");if(r!=null&&r==o){t.push('<button type="button" name="option" value="'+o+'" class="btn btn-large btn-block active">'+String.fromCharCode(65+o)+"</button>")}else{t.push('<button type="button" name="option" value="'+o+'" class="btn btn-large btn-block">'+String.fromCharCode(65+o)+"</button>")}}e.push("</ol></div></div>");t.push("</div>");$("#options").html(e.join(""));$("#options").append(t.join(""));break;case"2":e.push('<div class="span10"><div class="option-box"><ol type="A">');t.push('<div class="span2 btn-group" data-toggle="buttons-checkbox" id="multiple-type">');var i=n.split(SEPARATOR);var s=i.length;var u=[];if(r!=null){u=r.split(SEPARATOR)}for(var o=0;o<s;o++){e.push("<li>"+i[o]+"</li>");if(jQuery.inArray(o.toString(),u)>=0){t.push('<button type="button" name="mult" value="'+o+'" class="btn btn-large btn-block active">'+String.fromCharCode(65+o)+"</button>")}else{t.push('<button type="button" name="mult" value="'+o+'" class="btn btn-large btn-block">'+String.fromCharCode(65+o)+"</button>")}}e.push("</ol></div></div>");t.push("</div>");$("#options").html(e.join(""));$("#options").append(t.join(""));break;case"3":e.push('<input type="number" id="integer-type" value="'+r+'">');$("#options").html(e);break;case"4":var i=n.split(SEPARATOR+SEPARATOR);var a=i[0].split(SEPARATOR);var f=i[1].split(SEPARATOR);var l=a.length;var c=f.length;e.push('<div class="span6">');e.push('<table class="table"><tr><td>');e.push('<ol type="1">');for(var o=0;o<l;o++){e.push("<li>"+a[o]+"</li>")}e.push("</ol></td><td>");e.push('<ol type="A">');for(var o=0;o<c;o++){e.push("<li>"+f[o]+"</li>")}e.push("</ol></td></tr></table>");e.push("</div>");var u=[];if(r!=null){u=r.split(SEPARATOR+SEPARATOR)}t.push('<div class="span6">');t.push('<table class="table" id="matrix-type">');t.push("<tr><td></td>");for(var h=0;h<c;h++){t.push("<td>"+String.fromCharCode(65+h)+"</td>")}t.push("</tr>");for(o=0;o<l;o++){t.push("<tr><td>"+o+"</td>");for(var h=0;h<c;h++){if(u[o]!=null&&u[o].indexOf(h)!=-1){t.push('<td><input type="checkbox" name="multicheck-'+o+'" class="multicheck-'+o+'" value="'+h+'" checked></td>')}else{t.push('<td><input type="checkbox" name="multicheck-'+o+'" class="multicheck-'+o+'" value="'+h+'"></td>')}}t.push("</tr>")}t.push("</div>");$("#options").html(e.join(""));$("#options").append(t.join(""));break}},renderInfo:function(){var e=[];$("#single-type").hide();$("#multiple-type").hide();$("#integer-type").hide();$("#matrix-type").hide();$("#status").show();$("#options").show();$("#q-video").show();switch(this.model.get("typeId")){case"1":var t=this.model.get("status");if(t==null){e.push('<a class="pull-left" ><img class="media-object" src="img/cross.png"></a>');e.push('<div class="media-body">');e.push("<h3>YOU SELECTED NONE</h3>");e.push("<h3>CORRECT OPTION "+String.fromCharCode(65+parseInt(this.model.get("correctAnswer")))+"</h3>");e.push("</div>")}else{if(t==true){e.push('<img class="media-object pull-left" src="img/tick.png">');e.push('<div class="media-body">');e.push("<h3>YOU MARKED OPTION "+String.fromCharCode(65+parseInt(this.model.get("optionSelected")))+"</h3>");e.push("</div>")}else if(t==false){e.push('<img class="media-object pull-left" src="img/cross.png">');e.push('<div class="media-body">');e.push("<h3>YOU MARKED OPTION "+String.fromCharCode(65+parseInt(this.model.get("optionSelected")))+"</h3>");e.push("<h3>CORRECT OPTION "+String.fromCharCode(65+parseInt(this.model.get("correctAnswer")))+"</h3>");e.push("</div>")}}break;case"2":var t=this.model.get("status");var n=this.model.get("correctAnswer").split(SEPARATOR);var r=null;if(this.model.get("optionSelected")!=null){r=this.model.get("optionSelected").split(SEPARATOR)}if(t==null){e.push('<a class="pull-left" ><img class="media-object" src="img/cross.png"></a>');e.push('<div class="media-body">');e.push("<h3>YOU SELECTED NONE</h3>");e.push("<h3>CORRECT OPTION ");for(var i=0;i<n.length;i++){e.push(String.fromCharCode(65+parseInt(n[i]))+",")}e.push("</h3></div>")}else{if(t==true){e.push('<img class="media-object pull-left" src="img/tick.png">');e.push('<div class="media-body">');e.push("<h3>YOU MARKED OPTION ");for(var i=0;i<n.length;i++){e.push(String.fromCharCode(65+parseInt(n[i]))+",")}e.push("</h3></div>")}else if(t==false){e.push('<img class="media-object pull-left" src="img/cross.png">');e.push('<div class="media-body">');e.push("<h3>YOU MARKED OPTION ");var s=[];for(var i=0;i<r.length;i++){s.push(String.fromCharCode(65+parseInt(r[i])))}e.push(s.join(","));e.push("</h3>");e.push("<h3>CORRECT OPTION ");var s=[];for(var i=0;i<n.length;i++){s.push(String.fromCharCode(65+parseInt(n[i])))}e.push(s.join(","));e.push("</h3></div>")}}break;case"3":var t=this.model.get("status");if(t==null){e.push('<a class="pull-left" ><img class="media-object" src="img/cross.png"></a>');e.push('<div class="media-body">');e.push("<h3>YOU ANSWERED NONE</h3>");e.push("<h3>CORRECT ANSWER "+this.model.get("correctAnswer")+"</h3>");e.push("</div>")}else{if(t==true){e.push('<img class="media-object pull-left" src="img/tick.png">');e.push('<div class="media-body">');e.push("<h3>YOU ANSWERED "+this.model.get("optionSelected")+"</h3>");e.push("</div>")}else if(t==false){e.push('<img class="media-object pull-left" src="img/cross.png">');e.push('<div class="media-body">');e.push("<h3>YOU ANSWERED "+this.model.get("optionSelected")+"</h3>");e.push("<h3>CORRECT ANSWER "+this.model.get("correctAnswer")+"</h3>");e.push("</div>")}}break;case"4":var o=[];var u=this.model.get("options");if(this.model.get("optionSelected")!=null){r=this.model.get("optionSelected").split(SEPARATOR+SEPARATOR)}if(this.model.get("correctAnswer")!=null){n=this.model.get("correctAnswer").split(SEPARATOR+SEPARATOR)}var t=this.model.get("status");if(t==null){e.push("<h3>YOU ANSWERED NONE</h3>")}else{if(t==true){e.push("<h3>YOU ANSWERED CORRECTLY</h3>")}else if(t==false){e.push("<h3>YOU ANSWERED INCORRECTLY</h3>")}}var a=u.split(SEPARATOR+SEPARATOR);var f=a[0].split(SEPARATOR);var l=a[1].split(SEPARATOR);var c=f.length;var h=l.length;e.push('<div class="span12">');e.push('<table class="table">');e.push("<tr><th>Option</th><th>Selected</th><th>Correct</th><th></th></tr>");for(var i=0;i<c;i++){e.push("<tr><td>"+f[i]+"</td>");if(t!=null){var p=r[i].split(SEPARATOR);var d=p.length;var s=[];for(var v=0;v<d;v++){s.push(String.fromCharCode(65+parseInt(p[v])))}e.push("<td>"+s.join(",")+"</td>")}else{e.push("<td>None</td>")}var m=n[i].split(SEPARATOR);var d=m.length;var s=[];for(var v=0;v<d;v++){s.push(String.fromCharCode(65+parseInt(m[v])))}e.push("<td>"+s.join(",")+"</td>");if(r[i]==n[i]){e.push('<td><img class="media-object pull-left" src="img/tick.png" style="margin:0px;width: 20px;"></td>')}else{e.push('<td><img class="media-object pull-left" src="img/cross.png" style="margin:0px;width: 20px;"></td>')}e.push("</tr>")}e.push("</table>");e.push("</div>");break}$("#stathead").html(e.join(" "));$("#diff").html(this.model.get("difficulty"));$("#avgAcc").html(this.model.get("averageCorrect"));$("#avgTime").html(helper.formatTime(this.model.get("timeTaken")));$("#tags").html(this.model.get("tagIds"));$("#solutionText").html(this.model.get("explanation"));$("#solution").show();jwplayer("analysis-video-"+this.model.get("id")).setup({file:this.model.get("videoSrc"),image:this.model.get("posterSrc"),startparam:"start",height:360,width:640,autostart:true,fallback:false,primary:"flash"});$("#time").html(helper.formatTime(this.model.get("timeTaken")));$("#submit").hide()}});window.QuizLibraryView=Backbone.View.extend({className:"container quiz-library",initialize:function(){this.filtered=new QuizCollection;this.type="0";this.l1="0";this.tness="0";this.rec="0"},events:{"change #f-type":"typeFilter","change #f-l1":"l1Filter","change #f-tness":"tnessFilter","click #s-rec":"recSort"},typeFilter:function(e){this.type=$("#f-type option:selected").val();this.renderQuizItems()},l1Filter:function(e){this.l1=$("#f-l1 option:selected").val();this.renderQuizItems()},tnessFilter:function(e){this.tness=$("#f-tness option:selected").val();this.renderQuizItems()},recSort:function(e){this.rec=this.rec=="1"?0:1;this.renderQuizItems()},render:function(){$(this.el).html(this.template());return this},onRender:function(){$(".selectpicker").selectpicker();this.renderQuizItems()},renderQuizItems:function(){$("#quizzes").empty();this.filtered.reset(this.collection.models);if(this.l1!="0"){var e=this.filtered.where({l1:this.l1});this.filtered.reset(e)}if(this.tness!="0"){var e=this.filtered.where({difficulty:this.tness});this.filtered.reset(e)}if(this.rec=="1"){var t=this.filtered.sortBy(function(e){return-parseInt(e.get("rec"))});this.filtered.reset(t)}var n=this.filtered.models;var r=n.length;if(r==0){$("#quizzes").html("<h3>No quizzes found. Try again...</h3>");return}$("#quizzes").html("");var i=0;while(i<r){$("#quizzes").append('<ul class="thumbnails"></ul>');for(var s=0;s<4&&i<r;s++){$(".thumbnails:last").append((new QuizItemView({model:n[i]})).render().el);i++}}}});window.QuizItemView=Backbone.View.extend({tagName:"li",className:"span3",initialize:function(){this.render()},events:{"click .box":"onQuizItemClick"},onQuizItemClick:function(){if(this.model.get("available")=="2"){return}if(this.model.get("hasAttempted")==true){return}else if(this.model.get("status")==this.model.STATUS_NOTSTARTED){mView.model=this.model;mView.show()}else{window.location="#quiz/"+this.model.get("id")}},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.FacDirectoryView=Backbone.View.extend({className:"container fac-dir",initialize:function(){this.filtered=new FacCollection;this.letters="";this.type="0";this.l1="0";this.totalTests="0";this.rec="0"},events:{"keyup #s-name":"nameSearch","change #f-l1":"l1Filter","click #s-rec":"recSort","click #s-tests":"testsSort"},nameSearch:function(){this.letters=$("#s-name").val();this.renderFacItems()},l1Filter:function(e){this.l1=$("#f-l1 option:selected").val();this.renderFacItems()},recSort:function(e){this.rec=this.rec=="1"?0:1;this.renderFacItems()},testsSort:function(e){this.totalTests=this.totalTests=="1"?0:1;this.renderFacItems()},render:function(){$(this.el).html(this.template());return this},onRender:function(){$(".selectpicker").selectpicker({btnStyle:"btn-small"});this.renderFacItems()},renderFacItems:function(){$("#fac-list").empty();this.filtered.reset(this.collection.models);if(this.letters!=""){var e=new RegExp(this.letters,"gi");var t=this.filtered.filter(function(t){if(e.test(t.get("firstName"))||e.test(t.get("lastName"))){return true}});this.filtered.reset(t)}if(this.l1!="0"){var n=this.filtered.where({l1Ids:this.l1});this.filtered.reset(n)}if(this.rec=="1"){var r=this.filtered.sortBy(function(e){return-parseInt(e.get("rec"))});this.filtered.reset(r)}if(this.totalTests=="1"){var r=this.filtered.sortBy(function(e){return-parseInt(e.get("totalQuizzes"))});this.filtered.reset(r)}var i=this.filtered.models;var s=i.length;if(s==0){$("#fac-list",this.el).html("<h3>No faculty found. Try again...</h3>");return}$("#fac-list",this.el).html("");for(var o=0;o<s;o++){$("#fac-list",this.el).append((new FacItemView({model:i[o]})).render().el)}}});window.FacItemView=Backbone.View.extend({tagName:"li",className:"fac-item box",initialize:function(){this.render()},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.ModalView=Backbone.View.extend({initialize:function(){this.state=false},events:{"hidden #modal":"close"},render:function(){this.$el.html(this.template(this.model.toJSON()));return this},show:function(){this.state=true;$(document.body).append(this.render().el);jwplayer("intro-vid-"+this.model.get("id")).setup({file:"videos/s"+this.model.get("id")+"introvid1.mp4",image:"img/introvid.png",startparam:"start",height:270,width:520,autostart:true,fallback:false,primary:"flash"});if(account.get("id")!=null){if(parseInt(account.get("quizzesRemaining"))>0){$("#take-btn").append('<a href="#quiz/'+this.model.get("id")+'" class="btn blue-btn">START TEST</a>')}else{$("#take-btn").append('<a href="#packages" class="btn blue-btn">You need to purchase a package to take this quiz.CLICK</a>')}}else{$("#take-btn").append('<a href="#signup" class="btn blue-btn">Log-In/Sign-Up to take Test</a>')}$("#modal").modal({backdrop:true})},close:function(){if(this.state!=true){return}$("#modal").modal("hide");this.state=false;jwplayer("intro-vid-"+this.model.get("id")).onReady(function(){jwplayer("intro-vid-"+this.model.get("id")).remove()});this.remove()}});window.SignUpView=Backbone.View.extend({initialize:function(){},render:function(){$(this.el).html(this.template());return this},onRender:function(){$("#login-box").append((new LoginBox({model:this.model})).render().el);$("#signup-box").append((new SignUpBox({model:this.model})).render().el)}});window.LoginBox=Backbone.View.extend({initialize:function(){console.log("Initializing Login View")},events:{"click #loginButton":"login","click #flogin":"fConnect","click #glogin":"gConnect"},render:function(){$(this.el).html(this.template());return this},fConnect:function(){this.model.set("type",2);user.login()},gConnect:function(){this.model.set("type",3);glogin()},login:function(e){e.preventDefault();this.model.login($("#email-lg").val(),$("#pass-lg").val())}});window.SignUpBox=Backbone.View.extend({initialize:function(){console.log("Initializing SignUp View")},events:{"click #signupButton":"signup","click #inviteButton":"invite"},render:function(){$(this.el).html(this.template());return this},ccSignUp:function(e){e.preventDefault();var t={email:$("#email-su").val(),password:$("#pass-su").val(),cPassword:$("#passcon-su").val(),firstName:$("#fname-su").val(),lastName:"dummy",ccode:$("#ccode").val(),streamId:streamId};this.model.ccSignUp(t)},signup:function(e){e.preventDefault();var t={email:$("#email-su").val(),password:$("#pass-su").val(),cPassword:$("#passcon-su").val(),firstName:$("#fname-su").val(),lastName:"dummy",streamId:streamId};this.model.signUp(t)},invite:function(e){e.preventDefault();var t={email:$("#email-su").val(),firstName:$("#fname-su").val(),lastName:"dummy",streamId:streamId};this.model.invite(t)}});window.ForgotPassView=Backbone.View.extend({initialize:function(){console.log("initializing forgot pass view")},events:{"click #forgotPassButton":"forgotPass"},render:function(){$(this.el).html(this.template());return this},forgotPass:function(e){e.preventDefault();this.model.forgotPass($("#forgotPassEmail").val())}});window.ChangePassView=Backbone.View.extend({className:"container forgotpass",initialize:function(){console.log("initializing change pass view")},events:{"click #changePassButton":"changePass"},render:function(){$(this.el).html(this.template());return this},changePass:function(e){e.preventDefault();this.model.changePass($("#currPassword").val(),$("#newPassword").val())}});window.PackagesView=Backbone.View.extend({className:"container packages",initialize:function(){this.render()},render:function(){$(this.el).html(this.template());return this},onRender:function(){var e=this.collection.models;var t=e.length;var n=0;while(n<t){$("#package-list").append('<ul class="thumbnails"></ul>');for(var r=0;r<3&&n<t;r++){$(".thumbnails:last").append((new PackageItemView({model:e[n]})).render().el);n++}}}});window.PackageItemView=Backbone.View.extend({tagName:"li",className:"span4",initialize:function(){},events:{"click #purchase":"purchase"},purchase:function(){this.model.purchase()},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.FacView=Backbone.View.extend({className:"container fac-profile",initialize:function(){_.bindAll(this,"render");this.model.bind("change",this.render)},events:{"click #recommendFac":"recommendFac"},recommendFac:function(){this.model.addReco()},render:function(){if(account.get("id")){this.model.set("loggedIn",true);$(this.el).html(this.template(this.model.toJSON()))}else{this.model.set("loggedIn",false);$(this.el).html(this.template(this.model.toJSON()))}return this},renderQuizzes:function(){var e=this.collection.models;var t=e.length;var n=0;while(n<t){$("#quizzes").append('<ul class="thumbnails"></ul>');for(var r=0;r<4&&n<t;r++){e[n].set("fid",this.model.get("id"));e[n].set("fdpURL",this.model.get("dpUrl"));e[n].set("firstName",this.model.get("firstName"));e[n].set("lastName",this.model.get("lastName"));e[n].set("bioShort",this.model.get("bioShort"));e[n].set("education",this.model.get("education"));$(".thumbnails:last").append((new QuizItemView({model:e[n]})).render().el);n++}}}});window.FacContactView=Backbone.View.extend({initialize:function(){console.log("Initializing faculty contact View");this.render()},events:{"click #contactButton":"submitContactForm"},render:function(){$(this.el).html(this.template());return this},submitContactForm:function(e){var t={email:$("#email").val(),firstName:$("#fname").val(),lastName:$("#lname").val(),phoneNumber:$("#phone").val(),about:$("#about").val()};e.preventDefault();var n=Config.serverUrl+"facContact/";return $.ajax({url:n,type:"POST",dataType:"json",data:t,success:function(e){if(e.status==STATUS.SUCCESS){}else{helper.showError(e.data)}}})}});window.ReviewView=Backbone.View.extend({initialize:function(){this.filtered=new FacCollection;this.l1="0";this.l2="0";this.l3="0";this.tness="0";this.status="0"},events:{"change #f-tness":"tnessFilter","change #f-status":"statusFilter","change #f-l1":"l1Filter"},l1Filter:function(e){this.l1=$("#f-l1 option:selected").val();this.renderQuestionItems()},tnessFilter:function(e){this.tness=$("#f-tness option:selected").val();this.renderQuestionItems()},statusFilter:function(e){this.status=$("#f-status option:selected").val();this.renderQuestionItems()},render:function(){$(this.el).html(this.template());return this},onRender:function(){$(".selectpicker").selectpicker();this.renderQuestionItems()},renderQuestionItems:function(){$("#q-list").empty();this.filtered.reset(this.collection.models);if(this.l1!="0"){var e=this.filtered.where({l1Id:this.l1});this.filtered.reset(e)}if(this.tness!="0"){var e=this.filtered.where({difficulty:this.tness});this.filtered.reset(e)}if(this.status=="1"){var e=this.filtered.where({isCorrect:true});this.filtered.reset(e)}else if(this.status=="2"){var e=this.filtered.where({isCorrect:false});this.filtered.reset(e)}var t=this.filtered.models;var n=t.length;if(n==0){$("#q-list",this.el).html("<h3>No questions found. Try again...</h3>");return}$("#q-list",this.el).html("");for(var r=0;r<n;r++){$("#q-list",this.el).append((new QuestionItemView({model:t[r]})).render().el)}var i=document.getElementById("q-list");MathJax.Hub.Queue(["Typeset",MathJax.Hub,i])}});window.QuestionItemView=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.ReviewQuestionView=Backbone.View.extend({className:"container reviewq",initialize:function(){this.qView=new QuizQuestionView},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this},onRender:function(){this.qView.model=this.model;$("#r-question").html(this.qView.render().el);this.qView.onRender()}});window.ResultsView=Backbone.View.extend({initialize:function(){this.activeView=null},events:{"click .resnav>li":"onNavClick","click #recommendQuiz":"recommendQuiz"},recommendQuiz:function(){this.model.addReco()},render:function(){$(this.el).html(this.template());return this},onRender:function(){var e=new ResultAnalysisView({model:this.model});$("#analysis-div").html(e.render().el);e.onRender();var t=new ResultGraphsView({model:this.model});$("#graphs-div").html(t.render().el);t.onRender();var n=new SolutionsView({model:this.model,index:0});$("#solutions-div").html(n.render().el);n.onRender();n.renderQuestion();$("#analysis-div").hide();$("#graphs-div").hide();$("#solutions-div").hide();this.switchView("analysis")},onNavClick:function(e){this.switchView(e.currentTarget.getAttribute("id"))},switchView:function(e){if(this.activeView!=null){$("#"+this.activeView).removeClass("active");$("#"+this.activeView+"-div").hide()}this.activeView=e;$("#"+this.activeView+"-div").slideDown();$("#"+this.activeView).addClass("active")}});window.ResultAnalysisView=Backbone.View.extend({initialize:function(){},calculateVideoArray:function(e){var t=[];_.each(e,function(e){videoResultObject={title:e.title||"",description:e.desc||"",image:e.posterSrc,sources:[{file:e.videoSrc,label:"360p"}]};t.push(videoResultObject)});return t},setUpPlaylist:function(e){jwplayer("results_video").setup({startparam:"start",height:640+210,width:360,autostart:true,fallback:false,primary:"flash",playlist:e,listbar:{position:"right",size:210}})},render:function(){var e=this.model.get("score");var t=quizQuestions.length;var n=this.model.get("numCorrect");var r=this.model.get("numIncorrect");var i=parseInt(t)-(parseInt(n)+parseInt(r));var s="";var o="";var u="";var a="";$(this.el).html(this.template({id:this.model.get("id"),totalQuestions:t,score:e,correct:n,incorrect:r,unattempted:i,maxScore:this.model.get("maxScore"),totalTime:helper.formatTime(this.model.get("allotedTime")),timeTaken:helper.formatTime(this.model.get("timeTaken")),avgTime:"1 min 30 secs",accuracyInsights:s,strategicInsights:u,historyInsights:a,difficultyInsights:o}));return this},onRender:function(){$("#video").html('<video id="results_video" class="video-js atlantis" controls preload="none" width="640" height="264" data-setup="{}"></video>');var e=this.calculateVideoArray(this.model.get("videoArray"));this.setUpPlaylist(e);var t=this.model.get("l3GraphData");if(t){var n=[];var r=t.length;for(var i=0;i<r;i++){var s=t[i];n.push('<div class="grey-box"><div class="row-fluid"><div class="span8">');n.push('<h3><span class="blue">'+sectionL3.get(s.lId).get("displayName")+'</span><span style="orange"> : '+(parseInt(s.scoreBefore)+parseInt(s.delta))+"</span>");if(parseInt(s.delta)>0){n.push('<span style="float:right"> +'+parseInt(s.delta)+"</span>")}else{n.push('<span style="float:right"> +'+parseInt(s.delta)+"</span>")}n.push("</h3><hr>");n.push('<div class="progress outline">');if(parseInt(s.delta)>0){n.push('<div class="bar bar-warning" style="width:'+parseInt(s.scoreBefore)+'%"></div>');n.push('<div class="bar bar-success" style="width:'+parseInt(s.delta)+'%"></div>')}else{var o=parseInt(s.scoreBefore)+parseInt(s.delta);n.push('<div class="bar bar-warning" style="width:'+o+'%"></div>');n.push('<div class="bar bar-danger" style="width:'+ -parseInt(s.delta)+'%"></div>')}n.push("</div></div>");n.push('<div class="span4">');n.push('<div class="stats">');n.push('<ul class="unstyled">');n.push('<li><i class="icon-signal"></i>'+s.numQ+" Questions</li>");n.push('<li><i class="icon-th-list"></i>'+s.numCorrect+" Correct</li>");n.push('<li><i class="icon-th-list"></i>'+s.numIncorrect+" Incorrect</li>");n.push("</ul></div></div></div></div>")}$("#topic-wise").html(n.join(" "))}}});window.ResultGraphsView=Backbone.View.extend({initialize:function(){this.activeInsights=""},events:{"click .insightItem>.btn":"onInsightClick"},switchView:function(e){$("#"+this.activeInsights+"-div").hide();this.activeInsights=e;$("#"+this.activeInsights+"-div").show()},onInsightClick:function(e){this.switchView(e.target.getAttribute("id"))},render:function(){$(this.el).html(this.template());return this},onRender:function(){drawTimeChart(this.model);drawDifficultyChart(this.model);$("#difficulty-div").hide();$("#history-div").hide();$("#strategy-div").hide();$("tspan:contains('Highcharts.com')").hide();this.switchView("timeTaken")}});window.SolutionsView=Backbone.View.extend({className:"container quizview",initialize:function(){this.index=this.options.index;this.questionView=new QuizQuestionView;this.question=null;this.questionIds=this.model.get("questionIdsArray");this.totalQuestions=this.questionIds.length;this.setUp()},setUp:function(){this.answersSelected=this.model.get("selectedAnswersArray");this.getTimeTakenPerQuestion=this.model.get("timePerQuestionArray");for(var e=0;e<this.totalQuestions;e++){var t=quizQuestions.get(this.questionIds[e]);if(this.getTimeTakenPerQuestion[e]!=null){t.set("timeTaken",this.getTimeTakenPerQuestion[e]);t.set("optionSelected",this.answersSelected[e]);t.setStatus();t.set("hasAttempted",true)}}},events:{"click #previous":"onPreviousClick","click #next":"onNextClick","click .qnolist":"onQNoClick"},onPreviousClick:function(){this.index--;if(this.index<0){return}this.renderQuestion()},onNextClick:function(){this.index++;if(this.index>=this.totalQuestions){return}this.renderQuestion()},onQNoClick:function(e){$("#"+this.index).removeClass("active");this.index=e.currentTarget.getAttribute("id");this.renderQuestion()},render:function(){$(this.el).html(this.template({totalQuestions:this.totalQuestions,hasAttempted:this.hasAttempted}));return this},onRender:function(){var e=this.questionIds.length;for(var t=0;t<e;t++){var n=quizQuestions.get(this.questionIds[t]);switch(n.get("status")){case true:$("#"+t).addClass("right");break;case false:$("#"+t).addClass("wrong");break;default:$("#"+t).addClass("unattempted");break}}},renderQuestion:function(){this.question=quizQuestions.get(this.questionIds[this.index]);if(this.question.get("timeTaken")==null){this.question.set("timeTaken",0)}this.questionView.model=this.question;$("#question").html(this.questionView.render().el);this.questionView.onRender();$("#qnum").html(parseInt(this.index)+1);$("#qtotal").html(this.totalQuestions);$("#previous").show();$("#next").show();if(this.index==0){$("#previous").hide()}else if(this.index==this.totalQuestions-1){$("#next").hide()}return null}});window.MySetsView=Backbone.View.extend({initialize:function(){this.historyView=new HistoryView({collection:this.collection})},render:function(){$(this.el).html(this.template());return this},onRender:function(){this.historyView.render()}});window.HistoryView=Backbone.View.extend({initialize:function(){},render:function(){var e=this.collection.models;var t=[];var n=[];var r=[];var i=e.length;for(var s=0;s<i;s++){var o=e[s];switch(o.get("status")){case o.STATUS_COMPLETED:n.push(o);break;case o.STATUS_INPROGRESS:t.push(o);break;case o.STATUS_INTERRUPTED:r.push(o);break}}i=t.length;var s=0;if(i==0){$("#paused").append("You dont have any paused tests.")}while(s<i){$("#paused").append('<ul class="thumbnails"></ul>');for(var u=0;u<3&&s<i;u++){$(".thumbnails:last","#paused").append((new QuizItemView({model:t[s]})).render().el);s++}}i=r.length;s=0;if(i==0){}while(s<i){$("#interruped").append('<ul class="thumbnails"></ul>');for(var u=0;u<3&&s<i;u++){$(".thumbnails:last","#interruped").append((new QuizItemView({model:r[s]})).render().el);s++}}i=n.length;s=0;if(i==0){$("#history").append("You have not taken any tests. Please take a test to update your history")}while(s<i){$("#history").append('<ul class="thumbnails"></ul>');for(var u=0;u<3&&s<i;u++){$(".thumbnails:last","#history").append((new QuizItemView({model:n[s]})).render().el);s++}}}})